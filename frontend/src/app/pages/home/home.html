<div *ngIf="!isLoggedIn">
  <div class="container mt-5">
    <div class="hero text-center">
      <h1 class="mb-2">POV WebApp</h1>
      <p class="lead mb-3">Organiza, invita y mide el desempe침o de tus eventos.</p>
      <div class="d-flex justify-content-center gap-2">
        <a routerLink="/login" class="btn btn-light btn-lg">Iniciar sesi칩n</a>
        <a routerLink="/register" class="btn btn-outline-light btn-lg">Registrate</a>
      </div>
    </div>
  </div>
</div>

<div *ngIf="isLoggedIn">
  <div class="container mt-4">
    <!-- CTA row -->
    <div class="d-flex" style="justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 8px;">
      <h2 style="margin:0;">Tu panel</h2>
      <a routerLink="/event/new" class="btn btn-light">
        <span class="bi bi-plus-circle"></span> Crear evento
      </a>
    </div>

    <!-- Desempe침o / Stats -->
    <div class="stats fade-in">
      <div class="stat-card">
        <h3>Invitado</h3>
        <p>{{ invitedCount }}</p>
      </div>
      <div class="stat-card">
        <h3>Propios</h3>
        <p>{{ ownedCount }}</p>
      </div>
      <div class="stat-card">
        <h3>Total del mes</h3>
        <p>{{ monthlyTotal }}</p>
      </div>
      <div class="stat-card">
        <h3>Pr칩ximo evento</h3>
        <p class="pill">
          <span class="bi bi-clock"></span> {{ nextEventLabel }}
        </p>
      </div>
    </div>

    <div class="spacer"></div>

    <div style="display:grid; grid-template-columns: 1fr 320px; gap: 16px; align-items:start;">
      <div>
        <h2 class="section-title"><span class="bi bi-person-check"></span> Invitaciones</h2>
        <div class="grid">
          <!-- Skeletons while loading -->
          <ng-container *ngIf="invitedEvents.length === 0; else invitedList">
            <div class="ev-card skeleton"></div>
            <div class="ev-card skeleton"></div>
          </ng-container>
          <ng-template #invitedList>
            <app-event-card *ngFor="let event of invitedEvents" [event]="event" [isOwner]="false"></app-event-card>
          </ng-template>
        </div>

        <h2 class="section-title mt-4"><span class="bi bi-star"></span> Tus eventos</h2>
        <div class="grid">
          <!-- Skeletons while loading -->
          <ng-container *ngIf="ownedEvents.length === 0; else ownedList">
            <div class="ev-card skeleton"></div>
            <div class="ev-card skeleton"></div>
          </ng-container>
          <ng-template #ownedList>
            <app-event-card *ngFor="let event of ownedEvents" [event]="event" [isOwner]="true"></app-event-card>
          </ng-template>
        </div>
      </div>

      <!-- Compact Calendar Sidebar -->
      <aside class="ev-calendar">
        <div class="ev-cal__header">
          <span class="bi bi-calendar3"></span>
          Calendario
        </div>
        <div class="ev-cal__body">
          <div class="ev-cal__month">{{ (invitedEvents[0]?.date || ownedEvents[0]?.date) | date:'MMMM yyyy' }}</div>
          <div class="ev-cal__days">
            <div *ngFor="let d of [1,2,3,4,5,6,7]; let i = index" class="ev-cal__dow">{{ ['L','M','X','J','V','S','D'][i] }}</div>
          </div>
          <div class="ev-cal__grid">
            <div *ngFor="let i of [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]" class="ev-cal__cell" [class.ev-cal__cell--has]="hasEventOn(i+1)">
              <span>{{ i + 1 }}</span>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>
